// https://github.com/Gillardo/bootstrap-ui-datetime-picker
// Version: 2.4.3
// Released: 2016-07-14 
angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",defaultTime:"00:00:00",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},initialPicker:"date",reOpenDefault:!1,enableDate:!0,enableTime:!0,buttonBar:{show:!0,now:{show:!0,text:"Now"},today:{show:!0,text:"Today"},clear:{show:!0,text:"Clear"},date:{show:!0,text:"Date"},time:{show:!0,text:"Time"},close:{show:!0,text:"Close"}},closeOnDateSelection:!0,closeOnTimeNow:!0,appendToBody:!1,altInputFormats:[],ngModelOptions:{},saveAs:!1,readAs:!1}).controller("DateTimePickerController",["$scope","$element","$attrs","$compile","$parse","$document","$timeout","$uibPosition","dateFilter","uibDateParser","uiDatetimePickerConfig","$rootScope",function(e,t,n,a,i,o,r,s,l,d,p,c){function u(n){var a=v[0],i=t[0].contains(n.target),o=void 0!==a.contains&&a.contains(n.target);!e.isOpen||i||o||e.$apply(function(){e.close(!1)})}function m(n){27===n.which&&e.isOpen?(n.preventDefault(),n.stopPropagation(),e.$apply(function(){e.close(!1)}),t[0].focus()):40!==n.which||e.isOpen||(n.preventDefault(),n.stopPropagation(),e.$apply(function(){e.isOpen=!0}))}function f(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function g(t){var n=d.parse(t,y,e.date);if(isNaN(n))for(var a=0;a<P.length;a++)if(n=d.parse(t,P[a],e.date),!isNaN(n))return n;return n}function b(e){if(angular.isNumber(e)&&!isNaN(e)&&(e=new Date(e)),!e)return null;if(angular.isDate(e)&&!isNaN(e))return e;if(angular.isString(e)){var t=g(e);if(!isNaN(t))return d.toTimezone(t,h.timezone)}else;}function D(t){return e.datepickerOptions.minDate&&t<e.datepickerOptions.minDate?!1:e.datepickerOptions.maxDate&&t>e.datepickerOptions.maxDate?!1:!0}function w(e,t){var a=e||t;return n.ngRequired||n.required||a?(angular.isNumber(a)&&(a=new Date(a)),a?angular.isDate(a)&&!isNaN(a)?D(a):angular.isDate(new Date(a))&&!isNaN(new Date(a).valueOf())?D(new Date(a)):angular.isString(a)?!isNaN(g(t))&&D(g(t)):!1:!0):!0}var k,h,v,y=p.dateFormat,O={},$=[],T=angular.isDefined(n.closeOnDateSelection)?e.$parent.$eval(n.closeOnDateSelection):p.closeOnDateSelection,S=angular.isDefined(n.closeOnTimeNow)?e.$parent.$eval(n.closeOnTimeNow):p.closeOnTimeNow,M=angular.isDefined(n.datepickerAppendToBody)?e.$parent.$eval(n.datepickerAppendToBody):p.appendToBody,P=angular.isDefined(n.altInputFormats)?e.$parent.$eval(n.altInputFormats):p.altInputFormats,x=angular.isDefined(n.saveAs)?e.$parent.$eval(n.saveAs)||n.saveAs:p.saveAs,N=angular.isDefined(n.readAs)?e.$parent.$eval(n.readAs):p.readAs;this.init=function(i){function r(e){if(k.$isEmpty(e))return e;var t=new Date(e);return angular.isDate(t)&&!isNaN(t)?t:e}function s(e){return!e||angular.isString(e)||!angular.isDate(e)||isNaN(e)?e:"ISO"===x?e.toISOString():"json"===x?e.toJSON():"number"===x?e.valueOf():l?d.fromTimezone(e,h.timezone).toLocaleString():(y=y.replace(/M!/,"MM").replace(/d!/,"dd"),d.filter(d.fromTimezone(e,h.timezone),y))}if(k=i,h=k.$options||p.ngModelOptions,e.buttonBar=angular.isDefined(n.buttonBar)?e.$parent.$eval(n.buttonBar):p.buttonBar,e.enableDate=angular.isDefined(e.enableDate)?e.enableDate:p.enableDate,e.enableTime=angular.isDefined(e.enableTime)?e.enableTime:p.enableTime,e.initialPicker=angular.isDefined(n.initialPicker)?n.initialPicker:e.enableDate?p.initialPicker:"time",e.reOpenDefault=angular.isDefined(n.reOpenDefault)?n.reOpenDefault:p.reOpenDefault,"date"==e.initialPicker&&!e.enableDate)throw new Error("datetimePicker can't have initialPicker set to date and have enableDate set to false.");e.showPicker=e.enableDate?e.initialPicker:"time";var l=!1;if(p.html5Types[n.type]?(y=p.html5Types[n.type],l=!0):(y=n.datetimePicker||p.dateFormat,n.$observe("datetimePicker",function(e){var t=e||p.dateFormat;if(t!==y&&(y=t,k.$modelValue=null,!y))throw new Error("datetimePicker must have a date format specified.")})),!y)throw new Error("datetimePicker must have a date format specified.");var c=angular.element('<div date-picker-wrap><div uib-datepicker></div></div><div time-picker-wrap><div uib-timepicker style="margin:0 auto"></div></div>');h?(timezone=h.timezone,e.ngModelOptions=angular.copy(h),e.ngModelOptions.timezone=null,e.ngModelOptions.updateOnDefault===!0&&(e.ngModelOptions.updateOn=e.ngModelOptions.updateOn?e.ngModelOptions.updateOn+" default":"default"),c.attr("ng-model-options","ngModelOptions")):timezone=null,c.attr({"ng-model":"date","ng-change":"dateSelection(date)"});var u=angular.element(c.children()[0]);e.datepickerOptions||(e.datepickerOptions={}),l&&"month"===n.type&&(e.datepickerOptions.datepickerMode="month",e.datepickerOptions.minMode="month"),u.attr("datepicker-options","datepickerOptions"),angular.isDefined(e.datepickerOptions.datepickerMode)||(e.datepickerOptions.datepickerMode="day");var D=angular.element(c.children()[1]);e.timepickerOptions||(e.timepickerOptions={});for(var O in e.timepickerOptions)"templateUrl"==O?D.attr(f(O),e.timepickerOptions.templateUrl):D.attr(f(O),"timepickerOptions."+O);angular.forEach(["minDate","maxDate","initDate"],function(t){e.datepickerOptions[t]&&("minDate"==t?D.attr("min","datepickerOptions.minDate"):"maxDate"==t&&D.attr("max","datepickerOptions.maxDate"))}),l?k.$formatters.push(function(t){return e.date=d.fromTimezone(t,h.timezone),t}):(k.$$parserName="datetime",k.$validators.datetime=w,k.$parsers.unshift(b),k.$formatters.push(function(t){return k.$isEmpty(t)?(e.date=t,t):(e.date=d.fromTimezone(t,h.timezone),y=y.replace(/M!/,"MM").replace(/d!/,"dd"),d.filter(e.date,y))})),x&&(angular.isFunction(x)?k.$parsers.push(x):k.$parsers.push(s),angular.isFunction(N)?k.$formatters.push(N):k.$formatters.push(r)),k.$viewChangeListeners.push(function(){e.date=g(k.$viewValue)}),t.bind("keydown",m),v=a(c)(e),c.remove(),M?o.find("body").append(v):t.after(v)},e.getText=function(t){return e.buttonBar[t].text||p.buttonBar[t].text},e.keydown=function(n){27===n.which&&(e.close(!1),t[0].focus())},e.doShow=function(t){return angular.isDefined(e.buttonBar[t].show)?e.buttonBar[t].show:p.buttonBar[t].show},e.dateSelection=function(a,i){if(e.enableTime&&"time"===e.showPicker&&(a||null!=a)&&(angular.isDefined(e.date)&&null!=e.date||(e.date=new Date),a&&null!=a)){var o=new Date(e.date);o.setHours(a.getHours()),o.setMinutes(a.getMinutes()),o.setSeconds(a.getSeconds()),o.setMilliseconds(a.getMilliseconds()),a=o}if(angular.isDefined(a)){if(!e.date){var r=angular.isDefined(n.defaultTime)?n.defaultTime:p.defaultTime,s=new Date("2001-01-01 "+r);isNaN(s)||null==a||(a.setHours(s.getHours()),a.setMinutes(s.getMinutes()),a.setSeconds(s.getSeconds()),a.setMilliseconds(s.getMilliseconds()))}e.date=a}var o=e.date?l(e.date,y):null;t.val(o),k.$setViewValue(o),T&&("time"!=e.showPicker&&null!=o?e.enableTime?e.open("time"):e.close(!1):S&&"time"===e.showPicker&&null!=o&&"now"===i&&e.close(!1))},e.$watch("isOpen",function(n){if(e.dropdownStyle={display:n?"block":"none"},n){O.openDate=e.date;var a=M?s.offset(t):s.position(t);M?e.dropdownStyle.top=a.top+t.prop("offsetHeight")+"px":e.dropdownStyle.top=void 0,e.dropdownStyle.left=a.left+"px",r(function(){e.$broadcast("uib:datepicker.focus"),o.bind("click",u)},0,!1),e.open(e.showPicker)}else o.unbind("click",u)}),e.isDisabled=function(t){("today"===t||"now"===t)&&(t=d.fromTimezone(new Date,timezone));var n={};return angular.forEach(["minDate","maxDate"],function(t){e.datepickerOptions[t]?angular.isDate(e.datepickerOptions[t])?n[t]=d.fromTimezone(new Date(e.datepickerOptions[t]),timezone):n[t]=new Date(l(e.datepickerOptions[t],"medium")):n[t]=null}),e.datepickerOptions&&n.minDate&&e.compare(t,n.minDate)<0||n.maxDate&&e.compare(t,n.maxDate)>0},e.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.select=function(t,n){angular.isDefined(n)&&(n.preventDefault(),n.stopPropagation());var a=null;if("today"===t||"now"==t){var i=new Date;angular.isDate(e.date)?(a=new Date(e.date),a.setFullYear(i.getFullYear(),i.getMonth(),i.getDate()),a.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):a=i}e.dateSelection(a,t)},e.open=function(t,n){angular.isDefined(n)&&(n.preventDefault(),n.stopPropagation()),r(function(){e.showPicker=t},0),"time"==t&&r(function(){e.date=g(k.$viewValue)},50)},e.close=function(n,a){angular.isDefined(a)&&(a.preventDefault(),a.stopPropagation()),e.isOpen=!1,e.enableDate&&e.enableTime&&(e.showPicker=e.reOpenDefault===!1?"date":e.reOpenDefault),angular.isDefined(n)?e.whenClosed({args:{closePressed:n,openDate:O.openDate||null,closeDate:e.date}}):t[0].focus()},e.$on("$destroy",function(){e.isOpen===!0&&(c.$$phase||e.$apply(function(){e.close()})),$.forEach(function(e){e()}),v.remove(),t.unbind("keydown",m),o.unbind("click",u)})}]).directive("datetimePicker",function(){return{restrict:"A",require:["ngModel","datetimePicker"],controller:"DateTimePickerController",scope:{isOpen:"=?",datepickerOptions:"=?",timepickerOptions:"=?",enableDate:"=?",enableTime:"=?",initialPicker:"=?",reOpenDefault:"=?",whenClosed:"&"},link:function(e,t,n,a){var i=a[0],o=a[1];o.init(i)}}}).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/date-picker.html"}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/time-picker.html"}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(e){"use strict";e.put("template/date-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'date\'" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click="$event.preventDefault(); $event.stopPropagation()"><li style="padding:0 5px 5px 5px" class=date-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class="btn-group pull-left" style=margin-right:10px ng-if="doShow(\'today\') || doShow(\'clear\')"><button type=button class="btn btn-sm btn-info" ng-if="doShow(\'today\')" ng-click="select(\'today\', $event)" ng-disabled="isDisabled(\'today\')">{{ getText(\'today\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\', $event)">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right" ng-if="(doShow(\'time\') && enableTime) || doShow(\'close\')"><button type=button class="btn btn-sm btn-default" ng-if="doShow(\'time\') && enableTime" ng-click="open(\'time\', $event)">{{ getText(\'time\')}}</button> <button type=button class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true, $event)">{{ getText(\'close\') }}</button></span> <span class=clearfix></span></li></ul>'),e.put("template/time-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'time\'" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click="$event.preventDefault(); $event.stopPropagation()"><li style="padding:0 5px 5px 5px" class=time-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class="btn-group pull-left" style=margin-right:10px ng-if="doShow(\'now\') || doShow(\'clear\')"><button type=button class="btn btn-sm btn-info" ng-if="doShow(\'now\')" ng-click="select(\'now\', $event)" ng-disabled="isDisabled(\'now\')">{{ getText(\'now\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\', $event)">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right" ng-if="(doShow(\'date\') && enableDate) || doShow(\'close\')"><button type=button class="btn btn-sm btn-default" ng-if="doShow(\'date\') && enableDate" ng-click="open(\'date\', $event)">{{ getText(\'date\')}}</button> <button type=button class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true, $event)">{{ getText(\'close\') }}</button></span> <span class=clearfix></span></li></ul>')}]);